---
timezone: UTC+8
---

# Wyatt

**GitHub ID:** Wyatt-cuhk

**Telegram:** @Wyatt_0420

## Self-introduction

我是港中文Fintech专业的应届生，目前在一家mm做pm，希望可以在这里学到更多web3工作内容，将学校学的知识真正应用在工作中。

## Notes

<!-- Content_START -->
# 2025-08-14

听的一愣一愣

- **Gas消耗监控** ：
  - **监控方式** ：可通过基准测试记录每步Gas消耗，在提PR时对比前后Gas情况来证明优化效果。
  - **适用情况** ：工程师团队较大或非常在意Gas消耗时可采用，说话人所在团队因开发者少且自行优化，未进行此项工作。
- **多版本合约部署** ：
  - **版本冲突问题** ：V3锁定0.7.6版本，V4锁定0.8.26版本，直接编译会报错，Uni将V3编译成二进制放入；说话人所在团队主合约锁定0.8.30，与V4不兼容，采用部署V4字节码到测试环境的方式。
  - **部署方法** ：通过特定指令获取V4编译后的字节码并处理，使用内联汇编的create 2进行部署，跳过字节码长度部分，部署时需给合约发钱，同时要配置文件权限允许读取。
- **等效性测试** ：
  - **测试原理** ：在V4源代码里有等效性测试，对同一批slot先在V3里做一次操作，再在V4里做一次，最后计算DFS判断输出是否一致，若不一致则报错。
  - **测试作用** ：可直接套用V3的形式化证明，监控代码修改情况。
- **FFI调用** ：
  - **调用原因** ：Solidity中一些数据函数（如指数计算）无法直接实现，可通过调用外部的Javascript代码（FFI）来判断Solidity输出与预期数学结果是否一致。
  - **调用配置** ：FFI需要特殊配置，且会大幅拉低合约运行速度，Uni对使用FFI的地方配置运行次数较少。
  - **Python调用示例** ：说话人在流动性项目中为证明数据库正确性，用Python写了版本，使用高精度的mp master库保证精度，通过运行命令行工具进行FFI调用并转换输出类型。
- **不变量测试** ：配置insert test进行不变量测试，具体概念在之前博客及文档中有介绍。
- **依赖管理与多版本引入** ：方锥s unit swap的依赖管理不够现代，可考虑使用solder；在引入与自身版本冲突的代码时，可采用部署二进制合约的方式。
- **代码架构** ：
  - **组合大于继承** ：现代编程提倡组合大于继承，V4虽有继承但较少做重载，用户自定义类型（0.8.30后引入）可优化代码开发体验，防止精度误用，是零成本抽象，编译时会还原为原始类型，可通过内联汇编做类型强制转换。
  - **Library调用方式** ：Library有两种调用方式，含internal或private函数的会编译到代码里，通过jump指令执行；含public或view修饰符的采用DELEGATECALL方式，会单独部署合约。
  - **Mapping存储** ：可通过特定方法确定Mapping的存储位置，默认情况下无需写内联汇编，直接用传统语法修改即可。
- **现代合约特性** ：
  - **少用view函数** ：为减少合约体积，现代合约尽量不写view函数，可通过export函数直接读取存储槽内容。
  - **单体架构** ：V4是单体合约，通过Mapping实现，优化了链式兑换的Gas消耗，但对于跨池操作少的项目（如借贷协议）不一定适用，需权衡开发成本和用户体验。
  - **Delta机制** ：可实现n笔操作统一清算，抵消资产和负债，优化V3中复杂的Callback逻辑，还可抵抗非on transfer代币。
  - **终局原子性** ：解决Flash loan问题，要求合约交易结束时账是平的，可进行任意多的swap，但不满足条件会revert，同时有call data不进内存的Gas优化。
- **审计相关** ：可蹭Uni的市场，将代码交给审计机构报价选择；关注审计公司之前审计项目与自身项目的关联度、附加服务（如形式化证明、bug bounty）及品牌差异。

# 2025-08-13

ETH
共识层 - 验证者 托管质押（模式简单，不牺牲资金流动性，不控制自己的资金）/独立质押（32ETH准入金，牺牲资金流动性，私钥由自己管理，需要运维节点，有较高技术门槛，需要支出硬件成本）
执行层 - users 

节点多样性

快速启动一个ETH Testnet
运行节点的要素：
以太坊网络由节点组成，以太坊网络的稳定性
依赖节点的稳定性：
 - 节点的可运维性
 - 节点的可观测性
 - 节点的安全性

# 2025-08-12

产品分享会

Defi
代码+算法替代传统金融中介
decen + 无许可 + 可验证 + 可组合性

//阅读Uniswap白皮书

Uniswap
2018 V1 AMM
2019 Add LPs
2020 ERC-20
2021 integration

SushiSwap的吸血鬼攻击

MakerDAO

DAO 超额抵押

挖矿第三定律：当你不知道Defi挖矿收益由谁提供，你就是提供的那个人

多签国库（Multisig Treasury），也称为多重签名钱包，是一种需要多个私钥共同授权才能执行交易的国库或账户 。它是一种加强安全性的机制，确保任何资金转移、合约交互或重要操作都需要由一个预设的团队或群体共同批准。

以下是多签国库的核心特点和作用：

**增强安全性**：多签国库的主要目标是防止单点故障和内部盗窃 。例如，如果一个国库需要3个私钥中的2个（2-of-3）来授权交易，那么即使其中一个私钥被盗或丢失，黑客也无法单独转移资金 。这大大降低了资金被恶意用户或黑客窃取的风险。
* **集体决策**：多签国库的设计使得项目的关键决策无法由一个人或一个单一实体做出 。它将权力分散到多个签名者手中，通常是项目的核心团队、DAO成员、基金会成员或社区代表。
***透明和问责**：所有交易都需要经过多方签名和链上记录，这为国库的资金管理提供了更高的透明度。签名者的身份和决策过程是公开可查的，这有助于提高团队的问责制。
* **用途广泛**：多签国库被广泛应用于管理DAO（去中心化自治组织）的社区资金、管理项目的开发资金、进行投资和支付等场景。例如，在DAO中，多签国库用于执行通过治理投票的提案，确保资金按照社区共识使用。

# 2025-08-11

技术分享会
后端差异较大：Smart Contract vs API服务器
前端强调钱包交互
数据储存在链上

智能合约/区块链机制

Solidity语言特性

运营分享会
技术vs非技术
市场：策划：内容/活动/产品
研究：市场/产品

运营：社区/内容/活动

BD：用户增长/合作/Ecosystem

Ownership

# 2025-08-10

Web3法律知识分享答疑会

招聘信息风险判断

红线：Crypto的发行和募资

风险要点：资金汇集，涉及法币交易的很难达到合规性，需要复杂的金融牌照
海外合规性：AML+KYC

项目扩张过程的传销风险规避
回避多级返佣与团队奖励

关注：洗钱链条的一环or外汇兑换的媒介

出入金需要注意KYC风险

高风险模块（混币）

「知情推断」

免责的前提是尽力防范

# 2025-08-08

一、Web3 合规性要求与常见法律风险
中国法律环境概览

主流监管基调：“全面封堵金融属性，有限容忍技术创新” 。

禁止事项：禁止ICO（首次代币发行） 、禁止虚拟货币交易所运营 、禁止境外交易平台向中国境内居民提供服务 、禁止虚拟货币作为支付工具 、打击非法集资、传销、洗钱、赌博等活动 。

核心法律风险梳理

代币发行与交易行为的法律风险

中国法律明令禁止任何单位或个人通过ICO、IEO、IDO等方式进行融资活动 。

不论代币是否命名为“积分”或“治理Token”，只要具备融资或可流通性，都可能构成非法金融行为 。

项目方若通过“空投”或“白名单”实质上向公众筹资，一旦规模扩大，可能被追究非法吸收公众存款罪 。

技术人员若参与代币模型设计、空投逻辑配置、合约部署等环节，也会被视为“共同行为人”而无法免责 。

赌博、传销、洗钱等刑事风险

开设赌场罪：链游中“充值—抽奖—提现”的闭环结构，容易被认定为开设赌场 。最高检新闻发布会指出，涉嫌赌博的应用软件，其显著特征是具有相关的提现功能 。

组织、领导传销活动罪：NFT项目、DAO社群、挖矿平台中，若设计“邀请返利”、“多级推广”等模式，涉及团队计酬或多层级返佣，可能触犯传销罪 。

洗钱与非法经营：场外交易（OTC）常被用作规避外汇监管的“地下换汇”工具 。未经许可撮合人民币与虚拟币交易，可能构成非法经营罪 。参与者若交易对手涉及电信诈骗等犯罪活动，可能被控洗钱罪 。

民商事争议

由于中国政策禁止虚拟货币作为法偿工具，涉及“币币交易”的合同，法院通常不予支持 。

虚拟货币买卖、委托他人投资等交易，大概率会被认定无效，即风险自担 。

委托代投者和受托方都需明确权利义务、保留协议及操作凭证，并严守权限，避免因管理不善而引发法律风险 。

全球监管背景与趋势

FATF（金融行动特别工作组）：是全球反洗钱和反恐怖融资标准的制定者 。

“旅行规则”：要求虚拟资产服务提供商（VASP）在转账时收集和传输发送方和接收方信息 。这对DeFi协议和DEX提出了合规挑战 。

稳定币监管：

监管必要性：稳定币总市值已超过1500亿美元，若主要稳定币出现问题可能引发系统性风险 。此外，稳定币可能影响传统金融体系的货币供应和跨境支付 。

监管目标：保护投资者、维护金融稳定、反洗钱合规 。

监管框架：欧盟MiCA法规禁止算法稳定币 ，对稳定币发行商提出严格的资本和流动性要求 。

监管趋势总结：

趋严化：各国都在加强加密货币监管，重点关注稳定币、交易所和DeFi协议 。
协调化：国际组织推动全球监管协调，各国框架逐渐趋同 。
创新友好：部分国家采用“监管沙盒”模式，在合规前提下支持区块链技术创新 。

二、常见网络安全风险与防护措施
常见网络安全风险与攻击方式

钓鱼攻击（Phishing）：
攻击手段：伪造官方网站、邮件或社交账号，诱导受害者点击恶意链接、输入敏感信息（如助记词、私钥） 。例如，冒充学校合作方发布“奖学金空投”表单，要求连接钱包并签名，从而盗走资产 。

后果：钱包资产被盗、个人信息泄露、电脑被植入后门 。

恶意软件/木马（Malware & Trojan）：
攻击手段：伪装成面试/学习软件，诱导下载安装 。木马程序可实现剪贴板劫持、浏览器扩展后门、远程控制等 。

后果：钱包助记词/私钥泄露、账号密码被窃取、电脑被远程操控 。

社交工程攻击（Social Engineering）：
攻击手段：冒充HR、导师或朋友，获取信任后诱导用户转账或点击恶意链接 。

后果：个人信息泄露、钱包资产被盗、被利用为“跳板”继续攻击他人 。

地址污染与扫描木马（Clipper/Scanning Bots）：
攻击手段：木马监控剪贴板内容，一旦检测到钱包地址，自动替换为攻击者的地址 。

后果：资金转入错误地址，无法追回 。

传统隐私与账号安全风险：
攻击手段：弱密码/密码复用、邮箱/SIM卡劫持、未开启双因素认证（2FA） 。

后果：所有账号被盗、资产损失、个人隐私泄露 。

防护清单：

面试/实习：提醒用户拒绝安装任何“专用面试软件”，并多渠道核实面试邀请的真实性 。

钱包与转账：在产品设计中，务必提醒用户转账前核对地址前6位和后4位，防止剪贴板被劫持 。
教育用户将助记词/私钥离线保存，绝不截图或上传网盘 。
引导用户定期检查钱包授权，并提供工具（如Revoke.cash）来管理和取消不必要的授权 。

账号与密码安全：
强调重要账户开启2FA，并优先推荐谷歌验证或硬件密钥，而非短信验证 。
建议用户使用密码管理器，为每个平台设置独立强密码 。

# 2025-08-07

8-6 补卡
从PM视角看智能合约章节

DApp架构和开发流程
作为产品经理，需要了解DApp的整体架构和开发生命周期以规划产品路线图 。
DApp架构组成：
前端: 用户交互界面，使用HTML、CSS和JavaScript构建 。与传统Web应用不同，DApp前端会连接区块链来调用智能合约，呈现数据和执行交易 。前端还需要集成区块链钱包（如MetaMask）来进行身份验证和签署交易 。
智能合约: DApp的核心，它定义了应用的业务逻辑 。智能合约部署在区块链上，通过执行自动化的规则来确保交易和操作的透明性与不可篡改性 。在以太坊平台上，智能合约通常使用Solidity编程语言编写，并通过EVM执行 。
数据检索器: 智能合约通常以Event形式释放日志事件 。数据检索器会检索这些数据并将其写入到PostgreSQL等传统数据库中，供前端进行数据展示 。
区块链和去中心化存储: 区块链用于存储智能合约的状态数据及交易记录 。去中心化存储如IPFS或Arweave，用于存储大规模的非结构化数据（如图片、文档等），确保数据不易丢失和篡改 。

DApp开发流程：
需求分析与规划: 确定应用目标、功能需求、选择合适的区块链平台（如以太坊、Solana）及设计用户体验 。
智能合约开发: 编写和测试核心业务逻辑，并进行安全审计以避免漏洞 。
检索器开发: 确定前端所需数据内容，编写和部署检索器程序来获取链上数据 。
前端开发: 构建用户界面，集成Web3钱包，显示区块链数据，并处理交易签名与确认 。
部署与上线: 将智能合约部署到测试网或主网，并将前端应用部署到去中心化或传统的Web服务上 。


安全实践（重点关注）：

重入攻击（Reentrancy）: 了解其攻击原理和防御措施 。历史上的The DAO事件就是因为此漏洞导致约6000万美元ETH被盗 。

访问控制（Access Control）: 意识到关键管理函数必须设置访问权限，以防止未经授权的用户调用，从而避免资金被盗或状态被篡改 。

合约部署与前端整合

测试网部署:

测试网（如Sepolia、Holesky）是用于开发、测试和部署智能合约的网络环境，它们模拟主网功能但使用无价值的测试代币 。

通过区块浏览器（如Sepolia Etherscan）查询合约部署地址、交易哈希和事件日志，这在产品发布后进行问题排查时非常有用 。

前端交互:

工作流程: 熟悉前端应用与合约交互的流程，包括初始化连接、用户授权、合约实例化、函数调用、交易签名和广播等步骤 。

ABI（应用二进制接口）: ABI是智能合约对外提供的接口描述规范 。在前端，ABI以JSON格式定义，描述合约中的函数、参数、返回类型等 。

交互类型: 区分两种主要交互方式：

写入操作（.send()）: 用于执行状态改变的交易 。需要用户在钱包中确认交易并支付gas费用 。

读取操作（.call()）: 用于执行只读查询或模拟操作 。不需要gas费用，不会改变区块链状态 。

高阶内容与开发协作
1. Gas优化
Gas是EVM执行操作的抽象工作量单位，每条指令消耗固定的gas。优化的目标是减少交易所需的总gas，以提高用户体验并降低成本。
减少存储操作（Storage Write）：读取存储的第一次操作需要2100 gas，后续则只需100 gas。写入storage的成本高达20,000 gas，因此推荐在多次访问同一存储数据时将其缓存到内存中，以减少SLOAD次数。
使用位压缩（Bit Packing）：将多个小变量压缩到一个uint256中，以节省存储空间。
循环优化：减少不必要的运算，例如将array.length缓存到变量中，而不是在每次循环中都重新读取。
函数可见性选择：external比public更节省gas，适用于仅被外部调用的函数。

2. 合约安全
智能合约一旦部署就无法修改，因此安全性至关重要。
安全设计原则：应遵循最小权限原则、模块化结构以方便审计，以及显式错误处理和事件记录。
重入攻击（Reentrancy）：恶意合约利用回调机制在合约状态更新之前重复调用受影响的函数，从而多次提取资金。历史上最著名的The DAO事件就是因为重入漏洞导致约6000万美元ETH被盗。防护方法是遵循“检查-生效-交互”模式，即先更新状态，再进行转账。
预言机操纵（Oracle Manipulation）：依赖外部价格源的合约可能因其价格被操纵而产生错误行为。防护措施包括使用Chainlink等权威价格源、增加时序约束和多源验证，或使用TWAP等加权算法。
整数溢出/下溢：在早期版本的Solidity（<v0.8.0）中，算术运算越界会产生错误数值。自Solidity 0.8.0起，所有算术运算默认开启溢出/下溢检查。
访问控制缺失：未受保护的管理函数可被任何人调用，导致严重安全风险。所有管理函数都应使用onlyOwner或Access Control修饰符保护。
未初始化代理：基于代理模式的合约若未正确执行初始化函数，可能被任意人初始化并接管合约。
前置交易/三明治攻击：攻击者在交易执行前后分别发送交易，以不利滑点或套利为目的。

3. 智能合约审计
智能合约审计是风险控制的关键手段，可以避免用户资产被盗。
常见工具：
Slither：以Python编写的静态分析工具，可检测安全漏洞和代码规范问题。
MythX：基于云平台的安全分析服务，支持命令行和API调用。
Foundry：高效的Solidity开发测试框架，支持属性测试（模糊测试）。
审计标准流程：包括静态分析、动态测试（Fuzzing）、人工审查和生成审计报告。

4. 开发协作规范
良好的协作规范能提升团队效率和代码质量。
GitHub工作流：
分支策略：主分支（main/master）保持可部署状态，开发分支（develop）用于日常功能开发，功能分支（feature/xxx）用于新功能开发，修复分支（fix/xxx）用于bug修复。
提交信息规范：使用简洁明确的提交信息，推荐格式为“类型: 简要描述”，类型包括feat（新功能）、fix（修复问题）、docs（文档更新）等。
Pull Request（PR）流程：每个功能或修复都应新建一个分支，PR提交前需确保本地所有测试通过、通过静态检查并包含必要文档。PR需要至少一位审查者批准。
Issue管理：对问题使用优先级标签和分类标签进行管理。Issue描述应详细，包含背景、问题、尝试过的方法和环境信息。
开源协作礼仪：所有代码变更需配测试和文档。应保持沟通公开透明，使用讨论区讨论重大设计变更。

5. Layer 2 解决方案
Layer 2是解决以太坊可扩展性和高成本问题的关键技术。
Rollup技术比较：
Optimistic Rollup：通过设定欺诈证明期来保证安全性，兼容EVM且成本低，但提现会有1-2周的延迟。
ZK Rollup：使用零知识证明来保证安全性，具有高安全性和快速提现的优点，但开发难度大且不完全EVM兼容。
主流L2平台概览：
Starknet：使用类Rust语言Cairo，采用ZK-STARK技术，具有极高扩展性。
zkSync：支持Solidity合约，是ZK Rollup，开发体验佳。
Arbitrum：基于Optimistic架构，兼容EVM工具链。
Base：由Coinbase推出，构建于OP Stack上，有强大的生态支持且开发成本低。

# 2025-08-06

今天主要学习行业概览部分

# 2025-08-05

今天完成了测试网测试；晚上的web3安全分享收获很多；完成钓鱼攻防挑战初学者阶段，有意思

# 2025-08-04

今天主要内容是区块链概览、以太坊概览、行业赛道全览及Web3工作方式。偏基础没有太多问题。


# 2025.07.30


<!-- Content_END -->
