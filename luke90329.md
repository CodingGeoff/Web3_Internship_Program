---
timezone: UTC+8
---

# Luke Hsu

**GitHub ID:** luke90329

**Telegram:** @luke90329

## Self-introduction

我是一名研究生，目前正在研究與智慧合約安全審計有關的主題。

## Notes

<!-- Content_START -->
# 2025-08-15

智能合約本身是一個封閉且確定的系統，無法主動獲取區塊鏈以外的真實世界數據（比如歐元對美元的匯率、氣溫等）。這種內外隔離的特性，就是所謂的 The Oracle Problem。
但許多高價值的應用（如：去中心化借貸、衍生品、保險）都極度依賴這些外部數據。為了解決這個問題，預言機 (Oracle) 就出現了，它是一個可信賴的數據源，負責將鏈下數據安全、可靠地餵送給鏈上智能合約使用。

但這也帶來了新的挑戰，如果 Oracle 本身是中心化的，那它就成了整個系統的單點故障和信任瓶頸，違背了區塊鏈去中心化的初衷。因此，有一個解決方案就是「去中心化預言機 」，例如最業界滿有名的 Chainlink。它透過聚合多個獨立節點的數據、設置質押與懲罰機制，來確保數據的準確性與抗操縱性。

雖然去中心化預言機解決了單點信任問題，但我們信任的鏈條從「單一實體」變成了一個節點網絡的經濟共識。這就引出了一個更深層次的問題：數據的「根信任」在哪裡？如果提供給 Oracle network 的源頭數據（例如交易所的 API）本身就被污染或操縱了，那不管 Oracle 再怎麼去中心化，也只是忠實地把錯誤的數據傳遞上鏈，所以說 Web3 的信任邊界，並不僅僅存在於鏈上。

# 2025-08-14

最近除了研究智能合約安全審計相關議題，也因為在以太坊中文周會上聽到和擴容有關的技術內容，覺得滿有趣的，就研究了一下並做個整理。

以太坊等 Layer 1 公鏈為了追求去中心化與安全性，犧牲了部分的可擴展性，導致交易速度慢（TPS 低） 且 Gas Fee 高昂。為了解決這個區塊鏈的不可能三角，L2擴容方案應運而生。

## Layer 2

Layer 2 的核心思想是將大量的交易計算與執行移到鏈下 (off-chain) 處理，再將最終的交易結果或證明打包壓縮，提交回 Layer 1 進行結算與確保安全。 這樣既能繼承 Layer 1 的安全性，又能大幅提升處理效率、降低用戶成本。

而目前主流的 L2 方案主要分為兩大類：

1. Optimistic Rollups：如 Arbitrum, Optimism 等，它假設所有鏈下交易都是有效的，並提供一個「爭議期」。任何人若發現無效交易，可在此期間提交 Fraud Proof 來挑戰並獲得獎勵。

2. ZK-Rollups：如 zkSync, StarkNet，它利用 zk proof，為每一批鏈下交易生成一個 Validity Proof。Layer 1 只需驗證這個證明，就能確信所有交易皆為有效，無需爭議期。

# 2025-08-13

過去幾天都在研究弱點/漏洞，但也學習到了一件事：僅靠人工審查程式碼難以發現所有漏洞，將自動化工具與最佳實踐融合進開發流程，是現今智能合約開發的必要環節。

## 核心工具

1. 靜態分析：如 Slither 等工具，能在不執行程式碼的情況下，掃描其是否符合已知的漏洞模式。它可以被整合進 CI/CD 流程，在每次提交時自動檢查，是第一道防線。

2. 動態分析與模糊測試：如 Foundry Fuzzing 或 Echidna 等工具，通過生成大量隨機輸入來測試合約，探索邊界條件和非預期狀態，能有效發現邏輯錯誤和數學漏洞。

3. 標準化函式庫：OpenZeppelin 提供了經過社群廣泛審計和實戰檢驗的合約組件（e.g. ERC20, AccessControl, ReentrancyGuard...etc），在開發時優先使用這些標準組件而非自己重新發明輪子，可以顯著減少低級錯誤。

自動化工具和標準函式庫極大地提高了開發的安全，但過度依賴它們也可能會讓開發者忽略了對協議自身複雜業務邏輯的審查。真正的安全源於"工具輔助下的嚴謹思維"與"持續學習"這兩件事，而非將安全責任完全外包給工具。工具抓的是「已知的未知」，而業務邏輯的漏洞往往是「未知的未知」。

# 2025-08-12

今天研究了近年各大 Web3審計報告中，影響最嚴重的弱點 Access Control：

根據 OWASP 發布的 2025 年智能合約十大安全風險 (OWASP Smart Contract Top 10)，存取控制 (Access Control)相關的漏洞是出現頻率最高的類別，凸顯了其在實務中的重要性。而存取控制簡單來說就是決定了「誰能做什麼」，不當的權限設計會讓合約門戶洞開，形同虛設。

## 常見漏洞與實踐

1. 未受保護的函式 (Unprotected Functions)：將只有管理員能呼叫的函式（如 selfdestruct, withdrawFees）暴露給所有人，是致命的低級錯誤。使用 onlyOwner 等 modifier 是基本操作。

2. tx.origin 驗證：tx.origin 指向交易的"最初發起者"，而非"直接呼叫者 (msg.sender)"；若使用 tx.origin 進行授權，合約將容易受到釣魚攻擊；一個惡意合約可以誘導用戶與其互動，再由它去呼叫目標合約，此時 tx.origin 是無辜的用戶，攻擊便可得逞。永遠優先使用 msg.sender 進行驗證。

3. 中心化風險：單一 owner 地址存在單點故障風險（如私鑰洩漏）。對於重要的協議，應考慮使用多簽錢包 或去中心化治理 (DAO) 來分散和制衡特權。

除了技術層面的多簽錢包，高權限操作的安全性也應考量治理層面的制衡。例如引入時間鎖機制，讓所有權限變更或重大操作都必須經過一段時間的公示期後才能生效，為社群提供審查和反應的時間，是防範惡意或錯誤操作的有效緩衝。

# 2025-08-11

昨天不小心偷懶了一天，今天繼續研究智能合約中經典的弱點：整數溢位 (Overflow or Underflow)。

整數溢位是 CS 的老問題了，幾乎每個程式語言都有這樣的弱點，但在智能合約中常常與資產相關，因此風險極高。

## 問題本質
在 Solidity 中，每個整數類型 (e.g. uint8, uint256)都有其固定的儲存範圍。

* Overflow: 當一個數值達到其類型上限時，再增加就會變為該類型的最小值（e.g. uint8 的 255 + 1 = 0）。

* Underflow: 當一個數值為 0 時，再減去 1 就會「翻轉」為該類型的最大值。

在代幣合約或任何記帳邏輯中，這類漏洞可能被用來無中生有地鑄造大量代幣，或繞過支付驗證。

## 解決方法
1. Solidity 0.8.0+: Solc 0.8.0 版本起，Solc 預設會對所有算術運算進行溢位檢查，若發生溢位則交易會被revert。

2. SafeMath 函式庫：在 Solc 0.8.0 之前的版本，普遍使用 OpenZeppelin 的 SafeMath Library 來對加減乘除進行安全的封裝。

3. unchecked{}: Solc 0.8.0+ 版本中，開發者可以明確使用 unchecked { ... } 來包覆程式碼，以節省 Gas 並表示此處的運算已確認不會溢位。

Solc 0.8.0+ 的內建保護機制大大提高了安全性，但也引發了關於效能與安全取捨的新思考；在極度追求 Gas efficiency 的場景，開發者可能會選擇使用 unchecked，但這就需要開發者必須對自己的數學邏輯有百分之百的把握，於是責任從「語言/框架」再次回到了「開發者」身上。

# 2025-08-09

今天在研究智能合約弱點資料集，看到了造成 The DAO事件的重入攻擊(Reentrancy)弱點，覺得很有趣就研究了一下。

## 攻擊原理
此漏洞發生於合約的狀態變更順序不當。當合約 A 呼叫外部合約 B 時，若在更新自身狀態（如：扣減餘額）之前就發送以太幣或進行外部呼叫，惡意的合約 B 就能夠利用這個時間差，"重入"合約 A 的函式，重複執行提款等操作，直到榨乾合約資產。

## 防禦方法
若要防止這類弱點，在開發時需要遵循"檢查-生效-互動" (Checks-Effects-Interactions)的開發模式：
1. Checks: 驗證所有前提條件，如餘額是否足夠。
2. Effects: 立即更新所有內部狀態變數，如更新餘額變數。
3. Interactions: 最後才與外部合約進行互動，如發送以太幣。

此外，使用 Re-entrancy Guard 也是一種常見且有效的防禦機制。

Checks-Effects-Interactions 看似簡單，但在複雜的 DeFi 協議中，函式間的呼叫鏈可能非常深。一個函式看似遵循了原則，但它呼叫的另一個內部函式可能又包含了外部呼叫，導致非預期的重入風險。

# 2025-08-08

我這幾天都在幫一間公司進行智能合約安全相關的教育訓練，有一些感悟：

不同於傳統的後端程式碼可以隨時修改、部署、打補丁，區塊鏈上的智能合約一旦部署，大部分情況下是不可變的，所以這代表如果合約中存在一個漏洞，那就如同在銀行的金庫設計圖上留下了一個後門，而且這個金庫還無法輕易更換或修理。

這個 Code is Law 的特性既是 Web3 世界的魅力，也是它的風險所在。任何人都可以看到鍊上合約的程式碼與交易紀錄，透明度極高，但也代表著駭客可以輕鬆的研究你的漏洞；而一旦漏洞被利用，損失的可能就是真金白銀，而且幾乎無法追回。

這就是為什麼智能合約的每一行程式碼都必須經過深思熟慮與嚴格審計。

# 2025-08-07

今日參與了Web3的法律知識分享會，讓我了解到，在做項目的時候，除了技術面和商業面，其實在監管和法律方面也會有許多需要注意的地方，還有包含出入金、KYC相關的財金法律知識。

# 2025-08-06

今天詳讀了SlowMist的文件，了解了許多智能合約相關的弱點和Defi攻擊事件和手法，對於我正在撰寫的論文有很大的幫助。

# 2025-08-05

今天參與了關於反釣魚的分享會，學習到了很多在Web3生態中的反釣魚觀念，受益良多，尤其是有些詐騙GAS的手法都和web2的不太一樣，很新奇！

# 2025-08-04

今天參與了以太坊中文周會，了解到很多最即時的幣圈相關的資訊以及以太坊近期的技術著重點，對於這個日新月異的圈子來說，有這樣一個週會我覺得是非常好的，畢竟可能隨時都有新的風口出現。


# 2025.07.30


<!-- Content_END -->
